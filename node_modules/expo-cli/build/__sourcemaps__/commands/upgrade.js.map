{"version":3,"sources":["commands/upgrade.ts"],"names":["maybeFormatSdkVersion","sdkVersionString","semver","valid","coerce","getUpdatedDependenciesAsync","projectRoot","workflow","targetSdkVersion","result","exp","pkg","ConfigUtils","readConfigJsonAsync","bundledNativeModules","JsonFile","readAsync","resolveModule","dependencies","devDependencies","Object","keys","forEach","name","log","warn","sdkVersion","expoReactNativeTag","facebookReactNativeVersion","facebookReactVersion","relatedPackages","upgradeAsync","requestedSdkVersion","options","process","cwd","isGitStatusClean","newLine","answer","type","message","ignoreDirtyGit","Versions","gteSdkVersion","attemptOldUpdate","error","CommandError","status","Project","currentStatus","stopAsync","chalk","bold","underline","addNewLineIfNone","currentSdkVersionString","sdkVersions","sdkVersionsAsync","latestSdkVersion","newestSdkVersionAsync","latestSdkVersionString","version","targetSdkVersionString","attemptUpdateAgain","updateToLatestSdkVersion","sdkVersionStringOptions","filter","v","gte","selectedSdkVersionString","pageSize","choices","map","value","attemptUnknownUpdate","packageManager","PackageManager","createForProject","npm","yarn","addAsync","writeConfigJsonAsync","updates","_","pickBy","_version","has","devDependenciesAsStringArray","dependenciesAsStringArray","length","addDevAsync","startReactNativeServerAsync","reset","nonPersistent","stopReactNativeServerAsync","green","grey","join","allDependencies","untouchedDependencies","difference","releaseNoteUrl","gray","skippedSdkVersions","_data","lt","gt","skippedSdkVersionKeys","releaseNotesUrls","values","data","releaseNotesUrl","reverse","url","program","command","alias","option","description","asyncAction"],"mappings":"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","file":"../../commands/upgrade.js","sourceRoot":"/expo-cli@3.9.1/src"}