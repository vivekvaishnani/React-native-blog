import Joi from '@hapi/joi';

import { Platform } from './constants';
import * as Android from './platforms/android';
import * as iOS from './platforms/ios';

type Job = Android.Job | iOS.Job;

const JobSchema = Joi.object({
  platform: Joi.string().valid(...Object.values(Platform)).required(),
})
  .when(
    Joi.object({ platform: Platform.Android }).unknown(),
    { then: Android.JobSchema },
  )
  .when(
    Joi.object({ platform: Platform.iOS }).unknown(),
    { then: iOS.JobSchema },
  );

export { Job, JobSchema };
